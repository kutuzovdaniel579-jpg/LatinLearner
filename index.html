<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LatinLearner</title>

    <link rel="icon" type="image/png" sizes="16x16" href="latin.png" />

    <!-- Tesseract.js voor OCR -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      video, canvas {
        width: 300px;
        border: 1px solid #ccc;
        margin-top: 10px;
      }
      button {
        margin-top: 15px;
        padding: 10px 15px;
        font-size: 16px;
      }
      #output {
        margin-top: 20px;
        padding: 10px;
        background: #f5f5f5;
        border-radius: 5px;
      }
    </style>
  </head>

  <body>
    <h1>LatinLearner</h1>
    <p>Maak een foto â†’ OCR â†’ Vertaling NL â†’ Latijn</p>

    <video id="camera" autoplay></video>
    <br />
    <button id="captureBtn">ğŸ“¸ Maak foto</button>

    <canvas id="snapshot"></canvas>

    <div id="output">
      <h3>ğŸ“„ Herkende tekst:</h3>
      <p id="recognizedText">Nog niets...</p>

      <h3>ğŸ›ï¸ Latijnse vertaling:</h3>
      <p id="latinText">Nog niets...</p>
    </div>

    <script>
      const video = document.getElementById("camera");
      const canvas = document.getElementById("snapshot");
      const recognizedText = document.getElementById("recognizedText");
      const latinText = document.getElementById("latinText");

      // Camera starten
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => video.srcObject = stream)
        .catch(err => alert("Camera toegang geweigerd: " + err));

      document.getElementById("captureBtn").onclick = async () => {
        // Foto maken
        const ctx = canvas.getContext("2d");
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0);

        // OCR uitvoeren
        recognizedText.textContent = "Bezig met tekst herkennen...";
        const result = await Tesseract.recognize(canvas, "nld");
        const text = result.data.text.trim();
        recognizedText.textContent = text || "Geen tekst gevonden.";

        // Vertalen NL â†’ Latijn
        latinText.textContent = "Bezig met vertalen...";
        const translation = await fetch(
          "https://api.mymemory.translated.net/get?q=" +
            encodeURIComponent(text) +
            "&langpair=nl|la"
        );
        const data = await translation.json();
        latinText.textContent = data.responseData.translatedText;
      };
    </script>
  </body>
</html>
